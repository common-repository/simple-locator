var WPSL_SearchHistoryMap=function(o,e){var n=this,t=jQuery;return n.locations=o,n.container=e,n.bindEvents=function(){t("[data-wpsl-history-per-page]").on("change",function(){t(this).parents("form").submit()})},n.loadmap=function(){var o,e=wpsl_locator_searchhistory.mapstyles,t=wpsl_locator_searchhistory.mappin?wpsl_locator_searchhistory.mappin:"",a=new google.maps.LatLngBounds,r=n.locations,s={mapTypeId:"roadmap",mapTypeControl:!1,zoom:8,styles:e,scrollwheel:!1,panControl:!1},i=new google.maps.InfoWindow,l=new google.maps.Map(document.getElementById(n.container),s);for(o=0;o<r.length;o++){var p=new google.maps.LatLng(r[o].latitude,r[o].longitude);a.extend(p);var c=new google.maps.Marker({position:p,map:l,title:r[o].search_term,icon:t});r[o].infowindow="<h4>"+r[o].date+"</h4>",r[o].infowindow+="<p>",r[o].infowindow+=wpsl_locator_searchhistory.searchTerm+": "+r[o].search_term,r[o].infowindow+="<br>"+wpsl_locator_searchhistory.searchTermFormatted+": "+r[o].search_term_formatted,r[o].infowindow+="<br>"+wpsl_locator_searchhistory.userIp+": "+r[o].user_ip,r[o].infowindow+="<br>"+wpsl_locator_searchhistory.distance+": "+r[o].distance,r[o].infowindow+="</p>",google.maps.event.addListener(c,"click",function(o,e){return function(){i.setContent(r[e].infowindow),i.open(l,o)}}(c,o)),l.fitBounds(a);var d=google.maps.event.addListener(l,"idle",function(){r.length<2&&l.setZoom(13),google.maps.event.removeListener(d)})}var m=google.maps.event.addListener(l,"bounds_changed",function(o){google.maps.event.removeListener(m)})},n.bindEvents()};